CREATE TABLE CARGO (
    ID_CARGO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME_CARGO VARCHAR2(20) NOT NULL,
    OBSERVACAO VARCHAR2(200)
);

CREATE TABLE TIPO_PAGAMENTO (
    ID_TIPO_PAGAMENTO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    TIPO_DE_PAGAMENTO VARCHAR2(20)NOT NULL
    );

CREATE TABLE SETOR (
    ID_SETOR NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME_SETOR VARCHAR2(50) NOT NULL,
    OBSERVACAO VARCHAR2(200)
);

CREATE TABLE CONVENIO (
    ID_CONVENIO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME_CONVENIO VARCHAR2(50) NOT NULL,
    CNPJ VARCHAR2(14) UNIQUE NOT NULL,
    TELEFONE VARCHAR2(20) NOT NULL
);

CREATE TABLE AUDITORIA (
    ID_AUDITORIA NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DATA_HORA_AUDITORIA DATE DEFAULT SYSDATE,
    ACAO_REALIZADA VARCHAR2(40) NOT NULL,
    TABELA_AFETADA VARCHAR2(50) NOT NULL
);

CREATE TABLE PACIENTE (
    ID_PACIENTE NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME VARCHAR2(100) NOT NULL,
    SEXO VARCHAR2(1) NOT NULL,
    DATA_NASCIMENTO DATE NOT NULL,
    ENDERECO VARCHAR2(100) NOT NULL,
    TELEFONE VARCHAR2(20) NOT NULL,
    EMAIL VARCHAR2(200) NOT NULL,
    CPF VARCHAR2(11) UNIQUE NOT NULL,
    CONSTRAINT CK_PACIENTE_SEXO CHECK (SEXO IN ('M','F'))
);

CREATE TABLE LEITO (
    ID_LEITO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_SETOR NUMBER,
    NUMERO_LEITO NUMBER(2) NOT NULL,
    STATUS VARCHAR2(10) NOT NULL,
    CONSTRAINT FK_LEITO_SETOR 
    FOREIGN KEY (ID_SETOR) REFERENCES SETOR (ID_SETOR)
);

CREATE TABLE COLABORADOR (
    ID_COLABORADOR NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_CARGO NUMBER,
    NOME VARCHAR2(200) NOT NULL,
    DATA_NASCIMENTO DATE,
    ENDERECO VARCHAR2(200) NOT NULL,
    TELEFONE VARCHAR2(20) NOT NULL,
    EMAIL VARCHAR2(100) NOT NULL,
    SEXO VARCHAR2(1),
    CPF VARCHAR2(11)UNIQUE NOT NULL,
    CONSTRAINT CK_COLABORADOR_SEXO CHECK (SEXO IN ('M','F')),

    CONSTRAINT FK_COLABORADOR_CARGO 
    FOREIGN KEY (ID_CARGO) REFERENCES CARGO (ID_CARGO)
);

CREATE TABLE PLANO_SAUDE (
    ID_PLANO_SAUDE NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_CONVENIO NUMBER,
    NOME_PLANO VARCHAR2(50) NOT NULL,
    TIPO_PLANO VARCHAR2(30) NOT NULL,
    PRECO NUMBER(10,2) NOT NULL,
    OBSERVACAO VARCHAR2(200),
    CONSTRAINT FK_PLANO_SAUDE_CONVENIO 
    FOREIGN KEY (ID_CONVENIO) REFERENCES CONVENIO (ID_CONVENIO)
);

CREATE TABLE AGENDAMENTO (
    ID_AGENDAMENTO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_PLANO_SAUDE NUMBER,
    ID_PACIENTE NUMBER,
    ID_COLABORADOR NUMBER,
    VALOR_ORCAMENTO NUMBER(10,2) NOT NULL,
    DATA_INICIO DATE NOT NULL,
    DATA_FIM DATE NOT NULL,
    TIPO_ATENDIMENTO VARCHAR2(10) NOT NULL,
    OBSERVACAO VARCHAR2(200),
    CONSTRAINT FK_AGEND_PLANO_SAUDE 
    FOREIGN KEY (ID_PLANO_SAUDE) REFERENCES PLANO_SAUDE (ID_PLANO_SAUDE),

    CONSTRAINT FK_AGEND_PACIENTE 
    FOREIGN KEY (ID_PACIENTE) REFERENCES PACIENTE (ID_PACIENTE),

    CONSTRAINT FK_AGEND_COLABORADOR 
    FOREIGN KEY (ID_COLABORADOR) REFERENCES COLABORADOR (ID_COLABORADOR)
);

CREATE TABLE REGISTRO_ATENDIMENTO (
    ID_REGISTRO_ATENDIMENTO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_AGENDAMENTO NUMBER,
    ID_LEITO NUMBER,
    ID_PLANO_SAUDE NUMBER,
    DATA_INICIO_ATENDIMENTO DATE NOT NULL,
    VALOR_FATURADO NUMBER(10,2) NOT NULL,
    STATUS_PAGAMENTO VARCHAR2(20) NOT NULL,
    DIAGNOSTICO VARCHAR2(50) NOT NULL,
    DATA_HORA_ALTA DATE,
    INTERNACAO VARCHAR2(5) NOT NULL,
    STATUS VARCHAR2(20) NOT NULL,
    OBSERVACAO VARCHAR2(200),
    CONSTRAINT CK_REGIST_ATEND_INTERNACAO CHECK (INTERNACAO IN ('SIM','NAO')),

    CONSTRAINT FK_REGIST_ATEND_AGENDAMENTO 
    FOREIGN KEY (ID_AGENDAMENTO) REFERENCES AGENDAMENTO (ID_AGENDAMENTO),

    CONSTRAINT FK_REGIST_ATEND_LEITO 
    FOREIGN KEY (ID_LEITO) REFERENCES LEITO (ID_LEITO),

    CONSTRAINT FK_REGIST_ATEND_PLANO_SAUDE 
    FOREIGN KEY (ID_PLANO_SAUDE) REFERENCES PLANO_SAUDE (ID_PLANO_SAUDE)
);

CREATE TABLE PROJETO_PESQUISA (
    ID_PROJETO_PESQUISA NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_REGISTRO_ATENDIMENTO NUMBER,
    NOME_PROJETO VARCHAR2(50) NOT NULL,
    STATUS VARCHAR2(20) NOT NULL,
    OBJETIVO VARCHAR2(20) NOT NULL,
    OBSERVACAO VARCHAR2(200),
    CONSTRAINT FK_PROJ_PESQ_REGIST 
    FOREIGN KEY (ID_REGISTRO_ATENDIMENTO) REFERENCES REGISTRO_ATENDIMENTO (ID_REGISTRO_ATENDIMENTO)
);


CREATE TABLE PROCEDIMENTO_PRECO (
    ID_PROCEDIMENTO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_AGENDAMENTO NUMBER,
    NOME_PROCEDIMENTO VARCHAR2(20) NOT NULL,
    PRECO NUMBER(10,2) NOT NULL,
    OBSERVACAO VARCHAR2(200),
    CONSTRAINT FK_PROC_PRECO_AGEND 
    FOREIGN KEY (ID_AGENDAMENTO) REFERENCES AGENDAMENTO (ID_AGENDAMENTO)
);

CREATE TABLE HISTORICO_PACIENTE (
    ID_HISTORICO_PACIENTE NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_PACIENTE NUMBER,
    ID_REGISTRO_ATENDIMENTO NUMBER,
    DATA_REGISTRO DATE NOT NULL,
    OBSERVACAO VARCHAR2(200),
    CONSTRAINT FK_HIST_PACIENT_PACIENT 
    FOREIGN KEY (ID_PACIENTE) REFERENCES PACIENTE (ID_PACIENTE),

    CONSTRAINT FK_HIST_PACIENT_REGIST 
    FOREIGN KEY (ID_REGISTRO_ATENDIMENTO) REFERENCES REGISTRO_ATENDIMENTO (ID_REGISTRO_ATENDIMENTO)
);

CREATE TABLE ITEM_FATURAMENTO (
    ID_ITEM_FATURAMENTO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_PROCEDIMENTO NUMBER,
    ID_REGISTRO_ATENDIMENTO NUMBER,
    ACRESCIMO NUMBER(10,2),
    DESCONTO NUMBER(10,2),
    NOVO_VALOR NUMBER(10,2) NOT NULL,
    CONSTRAINT FK_ITEM_FATUR_PROCED 
    FOREIGN KEY (ID_PROCEDIMENTO) REFERENCES PROCEDIMENTO_PRECO (ID_PROCEDIMENTO),

    CONSTRAINT FK_ITEM_FATUR_REGIST_ATEND 
    FOREIGN KEY (ID_REGISTRO_ATENDIMENTO) REFERENCES REGISTRO_ATENDIMENTO (ID_REGISTRO_ATENDIMENTO)
);

CREATE TABLE EXAME_SOLICITADO (
    ID_EXAME_SOLICITADO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_PROCEDIMENTO NUMBER,
    ID_SETOR NUMBER,
    ID_REGISTRO_ATENDIMENTO NUMBER,
    NOME_EXAME VARCHAR2(50) NOT NULL,
    DATA_SOLICITACAO DATE NOT NULL,
    DATA_FINALIZACAO DATE,
    RESULTADO_EXAME VARCHAR2(200),
    LAUDO VARCHAR2(200),
    STATUS VARCHAR2(20) NOT NULL,
    CONSTRAINT FK_EXAME_SOLIC_PROCED 
    FOREIGN KEY (ID_PROCEDIMENTO) REFERENCES PROCEDIMENTO_PRECO (ID_PROCEDIMENTO),

    CONSTRAINT FK_EXAME_SOLIC_SETOR 
    FOREIGN KEY (ID_SETOR) REFERENCES SETOR (ID_SETOR),

    CONSTRAINT FK_EXAME_SOLIC_REGIST_ATEND 
    FOREIGN KEY (ID_REGISTRO_ATENDIMENTO) REFERENCES REGISTRO_ATENDIMENTO (ID_REGISTRO_ATENDIMENTO)
);

CREATE TABLE COLABORADOR_AUDITORIA (
    ID_AUDITORIA NUMBER,
    ID_COLABORADOR NUMBER,

    CONSTRAINT PK_COLABORADOR_AUDITORIA 
    PRIMARY KEY (ID_AUDITORIA, ID_COLABORADOR),

    CONSTRAINT FK_COLAB_AUDITORIA_AUD 
    FOREIGN KEY (ID_AUDITORIA) REFERENCES AUDITORIA (ID_AUDITORIA),

    CONSTRAINT FK_COLAB_AUDITORIA_COLAB 
    FOREIGN KEY (ID_COLABORADOR) REFERENCES COLABORADOR (ID_COLABORADOR)
);

CREATE TABLE PROJETO_PESQUISA_COLABORADOR (
    ID_COLABORADOR NUMBER,
    ID_PROJETO_PESQUISA NUMBER,
    CONSTRAINT PK_PROJETO_PESQUISA_COLABORADOR 
    PRIMARY KEY (ID_COLABORADOR, ID_PROJETO_PESQUISA),

    CONSTRAINT FK_PROJ_PESQ_COLAB_PESQ 
    FOREIGN KEY (ID_PROJETO_PESQUISA) REFERENCES PROJETO_PESQUISA (ID_PROJETO_PESQUISA),
    
    CONSTRAINT FK_PROJ_PESQ_COLAB_COLAB 
    FOREIGN KEY (ID_COLABORADOR) REFERENCES COLABORADOR (ID_COLABORADOR)
);

CREATE TABLE AGENDAMENTO_PROCEDIMENTO_PRECO (
    ID_PROCEDIMENTO NUMBER,
    ID_AGENDAMENTO NUMBER,
    CONSTRAINT PK_AGENDAMENTO_PROCEDIMENTO_PRECO 
    PRIMARY KEY (ID_AGENDAMENTO, ID_PROCEDIMENTO),

    CONSTRAINT FK_AGEND_PROCED_PROCED 
    FOREIGN KEY (ID_PROCEDIMENTO) REFERENCES PROCEDIMENTO_PRECO (ID_PROCEDIMENTO),

    CONSTRAINT FK_AGEND_PROCED_AGEND 
    FOREIGN KEY (ID_AGENDAMENTO) REFERENCES AGENDAMENTO (ID_AGENDAMENTO)
);

CREATE TABLE REGISTRO_ATENDIMENTO_SETOR (
    ID_REGISTRO_ATENDIMENTO NUMBER,
    ID_SETOR NUMBER,
    OBSERVACAO VARCHAR2(200),
    CONSTRAINT PK_REGISTRO_ATENDIMENTO_SETOR 
    PRIMARY KEY (ID_REGISTRO_ATENDIMENTO, ID_SETOR),

    CONSTRAINT FK_REGISTRO_ATENDIMENTO_SETOR_ATEND 
    FOREIGN KEY (ID_REGISTRO_ATENDIMENTO) REFERENCES REGISTRO_ATENDIMENTO (ID_REGISTRO_ATENDIMENTO),
    
    CONSTRAINT FK_REGISTRO_ATENDIMENTO_SETOR_SET
    FOREIGN KEY (ID_SETOR) REFERENCES SETOR (ID_SETOR)
);

CREATE TABLE REGISTRO_ATENDIMENTO_TIPO_PAGAMENTO (
    ID_TIPO_PAGAMENTO NUMBER,
    ID_REGISTRO_ATENDIMENTO NUMBER,
    VALOR_PAGO NUMBER(10,2) NOT NULL,
    DATA_PAGAMENTO DATE NOT NULL,
    PARCELAS NUMBER(2) NOT NULL,
    CONSTRAINT PK_REGISTRO_ATEND_TIPO_PAGAMENTO 
    PRIMARY KEY (ID_TIPO_PAGAMENTO, ID_REGISTRO_ATENDIMENTO),

    CONSTRAINT FK_REGISTRO_ATEND_TIPO_PAG_ATEND 
    FOREIGN KEY (ID_REGISTRO_ATENDIMENTO) REFERENCES REGISTRO_ATENDIMENTO (ID_REGISTRO_ATENDIMENTO),

    CONSTRAINT FK_REGISTRO_ATEND_TIPO_PAG_TIPO
    FOREIGN KEY (ID_TIPO_PAGAMENTO) REFERENCES TIPO_PAGAMENTO (ID_TIPO_PAGAMENTO)
);
